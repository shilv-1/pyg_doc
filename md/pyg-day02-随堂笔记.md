# 通用Mapper&Nginx&品牌管理

## 03_集成分页助手PageHelper

#### 目标

> 集成分页助手PageHelper简化分页查询

#### 整合步骤

+ 配置依赖jar包
+ 在mybatis全局配置文件中配置分页拦截器PageInterceptor
+ 使用PageHelper工具类实现分页

#### 小结

> 调用PageHelper工具类的startPage(当前页码,页大小)方法实现分页,得到PageInfo对象,它封装了分页后数据

## 04_集成通用Mapper

#### 目标

> 集成通用Mapper,简作单表CRUD功能，不用再写SQL语句。

#### 整合步骤

+ 配置依赖jar包
+ 修改实体类，加JPA注解，实现实体类与表之间的映射关系。
+ 自定义数据访问接口继承通用Mapper接口
+ 配置通用Mapper整合Spring
+ 通过通用Mapper接口中的方法快速实现CURD功能

#### 小结

> 通用Mapper实现CRUD方法
>
> + mapper.selectXxx() 查询方法
> + mapper.insertXxx() 添加方法
> + mapper.updateXxx() 修改方法
> + mapper.deleteXxx() 删除方法

## 05_代码生成器(快速开发)

#### 目标

> 生成代码、快速完成单表CRUD功能

#### 代码生成

+ 生成数据访问接口
+ 生成数据访问SQL映射文件
+ 生成服务接口类

#### 小结

> + 生成实体类
> + 生成服务接口实现类
> + 生成控制器类
> + 生成VueJS

## 06_配置域名访问后台系统

#### 目标

> 使用http://manager.pinyougou.com:9101/admin/index.html访问运营商管理后台系统

#### 配置方式

+ 第一种：手动修改hosts文件
+ 第二种：用SwitchHosts软件修改hosts文件

#### 小结

> 在hosts文件中增加域名与ip的映射。

## 07_Nginx反向代理服务器

#### 目标

> 解决9101端口问题,所有http请求都进入Nginx服务器,然后根据指定的域名转发到内部tomcat服务器

![1561601852433](assets/1561601852433.png)

#### 核心配置

```xml
 gzip  on;

    # 配置内部的web服务器	
    server {
        listen       80;
        server_name  manager.pinyougou.com;

	    proxy_set_header X-Forwarded-Host $host;
        proxy_set_header X-Forwarded-Server $host;

        location / {
	       proxy_pass http://127.0.0.1:9101;
	       proxy_connect_timeout 600;
	       proxy_read_timeout 600;
        } 
    }
```

#### 小结

> 访问流程图：【资料\Nginx反向代理流程图.png】

## 08_查询品牌

#### 目标

> 实现品牌列表的查询（不用分页和条件查询）

![1561604115816](assets/1561604115816.png)

#### 前端代码

![1561603676704](assets/1561603676704.png)

#### 小结

> 前端发送异步请求,后端查询tb_brand表中的数据

## 09_增加品牌

#### 目标

> 实现品牌增加功能

#### 前端代码

重点：数据怎么封装 {key 来自实体类中的属性 : ''}

![1561604667250](assets/1561604667250.png)

![1561605153332](assets/1561605153332.png)

#### 后端代码

+ 第一步: 控制器定义方法
+ 第二步：调用服务接口
+ 第三步：调用服务接口实现类
+ 第四步：调用数据访问接口

#### 小结

> 前端封装表单数据,发送异步请求
>
> 后端接收请求参数,数据保存到tb_brand表

## 10_修改品牌

#### 目标

> 实现品牌修改功能

#### 前端代码

![1561605857139](assets/1561605857139.png)

#### 后端代码

+ 第一步: 控制器定义方法
+ 第二步：调用服务接口
+ 第三步：调用服务接口实现类
+ 第四步：调用数据访问接口

#### 小结

> 前端实现数据回显,数据封装,发送异步请求
>
> 后端接收请求参数,修改tb_brand表中的数据

## 11_分页查询品牌(前端代码)

#### 目标

> 实现分页查询品牌前端代码

#### 实现步骤

- 显示分页组件

  ```javascript
  <!-- 分页组件 -->
  <script src="/js/pagination.js"></script>
  <!-- 分页组件 -->
  
  <!-- 显示分页组件
      :pages: 总页数
      :current: 当前页码
      @navpage: 事件方法
  -->
  <pagination :pages="pages" :current="page" @navpage="search"/>
  ```

- 分页参数：当前页码、页大小

- 获取响应数据：品牌分页数据，总页数

  ![1561608085490](assets/1561608085490.png)

#### 小结

> 前端显示分页组件,分页参数传递到后端

## 12_分页查询品牌(后端代码)

#### 目标

> 实现分页查询品牌后端代码

#### 实现步骤

- 控制器定义分页查询方法，接收请求参数
- 定义分页实体类封装分页响应数据
- 调用服务接口
- 调用服务接口实现类
- 调用数据访问接口

#### 小结

> 接收分页参数，调用PageHelper的startPage()方法实现分页。自定义PageResult实体类封装响应数据。

## 13_多条件分页查询品牌(前端代码)

#### 目标

> 实现多条件分页查询品牌前端代码

#### 实现步骤

![1561609295083](assets/1561609295083.png)

![1561609526548](assets/1561609526548.png)

#### 小结

> 查询条件用json对象封装，查询条件参数传递到后端。

## 14_多条件分页查询品牌(后端代码)

#### 目标

> 实现多条件分页查询品牌后端代码

![1561610386509](assets/1561610386509.png)

#### 实现步骤

- 控制器接收请求参数
- 动态查询

#### 小结

> 接收请求参数,GET请求中文转码,动态查询语句
>
> 关键点: mybatis动态查询 where条件尽量采用#{}取值，防SQL注入。

## 15_删除品牌(前端代码)

#### 目标

> 实现批量删除品牌前端代码

#### 实现步骤

![1561610541424](assets/1561610541424.png)

#### 小结

> 数组封装多个品牌id

## 16_删除品牌(后端代码)

#### 目标

> 实现批量删除品牌后端代码

#### 实现步骤

- 控制器

- 服务接口

- 服务接口实现类

- 数据访问接口

  ![1561612104503](assets/1561612104503.png)

#### 小结

> 用通用Mapper的deleteByExample()方法实现批量删除品牌,Criteria封装删除条件in(?,?,?)

## 17_单独JS文件

#### 目标

> 实现VueJS代码定义在外部js文件

#### 实现步骤

- 定义brandController.js文件
- 在brand.html页面引入brandController.js

#### 小结

> 好处：js代码与html页面分离，方便管理。