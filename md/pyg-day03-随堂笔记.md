# 规格管理&模板管理

## 03_代码生成器

#### 目标

> 生成前端VueJS代码，实现前端快速开发。

## 04_规格管理需求分析

#### 目标

> 了解规格管理表结构、CRUD操作几张表

tb_specification: 规格表(主)

tb_specification_option: 规格选项表(从)

#### 小结

> 规格管理实际上对两张表进行操作: 规格表 与 规格选项表

## 05_多条件分页查询规格

#### 目标

> 实现多条件分页查询规格

#### 实现步骤

+ 前端实现

  ![1561769798468](assets/1561769798468.png)

+ 后端实现(略)

#### 小结

> 分页显示,查询条件封装,发送异步请求,显示规格数据。

## 06_添加规格需求分析

#### 目标

> 如何实现添加规格功能

#### 实现分析

![1561771415185](assets/1561771415185.png)

+ 前端数据封装 axios.post(url,{});

   {

  ​    specName : ''

  ​    specificationOptions: [{optionName : '', orders : ''},{},{}]

   }

+ 后端数据接收

  Specification.java

  -- private String specName;

  -- private List<SpecificationOption> specificationOptions;

  ```java
  /** 规格属性集合 */
  @Transient // 告诉通用Mapper该属性不是表中的列
  private List<SpecificationOption> specificationOptions;
  ```

#### 小结

> 前端数据封装: 
>
> {
>
> ​    specName : ''
>
> ​    specificationOptions: [{optionName : '', orders : ''},{},{}]
>
>  }
>
> 后端参数接收: 规格实体

## 07_添加规格(前端代码)

#### 目标

> 实现添加规格前端代码

#### 实现步骤

- 添加一行

- 删除一行

  ```javascript
  var arr = [10,20,30];
  alert(arr);
  
  // 获取元素在数组中的索引号
  var idx = arr.indexOf(20);
  
  /**
   * 第一个参数：元素在数组中的索引号
   * 第二个参数：删除的个数
   */
  arr.splice(idx,1);
  alert(arr);
  ```

- 表单数据绑定

- 按钮事件绑定

- 发送异步请求

#### 小结

> 参数封装,发送异步请求。
>
> 关键点: 参数封装格式
>
> {
>
> ​    specName : ''
>
> ​    specificationOptions: [{optionName : '', orders : ''},{},{}]
>
>  }

## 08_添加规格(后端代码)

#### 目标

> 实现添加规格后端代码

#### 实现步骤

+ 控制器
+ 服务接口
+ 服务接口实现类(两张表的数据插入)

#### 小结

> 请求参数接收,往规格表、规格选项表插入数据。
>
> 后端往规格选项表插入多行数据: 

## 09_修改规格

#### 目标

> 实现修改规格功能

#### 实现步骤

- 前端实现

  + 修改绑定点击事件(数据回显)

  + 根据规格id从规格选项表查询数据

    SELECT * FROM tb_specification_option WHERE spec_id = 27 ORDER BY orders

    ![1561775541256](assets/1561775541256.png)

- 后端实现

  ![1561776680822](assets/1561776680822.png)

#### 小结

![1561777015865](assets/1561777015865.png)

## 10_删除规格

#### 目标

> 实现删除规格功能

#### 实现步骤

- 前端实现

  ![1561777251012](assets/1561777251012.png)

- 后端实现

  ![1561778040587](assets/1561778040587.png)

#### 小结

> 删除两张表的数据

## 11_模板管理需求分析

#### 目标

> 了解模板管理表结构

![1561778680078](assets/1561778680078.png)

#### 小结

> 类型模板表 实际上它是 品牌表 与 规格表 的中间表。

## 12_多条件分页查询模板

#### 目标

> 实现多条件分页查询模板

#### 实现步骤

- 前端实现
- 后端实现

#### 小结

> 分页显示,查询条件封装,发送异步请求,显示数据。

## 13_添加模板需求分析

#### 目标

![1561780384040](assets/1561780384040.png)

> 前端请求参数封装? 
>
> {name: '',
>
>  brandIds : [{},{}],
>
>  specIds:[{},{}],
>
>  customAttrbuteItems:[{},{}]}
>
> 后端请求参数接收? 
>
> TypeTemplate.java

#### 需求分析

- 品牌下拉列表(vue多选下拉列表框组件)
- 规格下拉列表(vue多选下拉列表框组件)
- 扩展属性

## 14_vue-select组件

#### 目标

> 掌握vue-select组件的简单运用

#### 实现步骤

- 引入js(vue-select.js)

- 注册组件

  ```
  // 注册组件
  Vue.component('v-select', VueSelect.VueSelect);
  ```

- 页面使用

  ```
  <!--
     :options：配置数据源
     label: 选中显示名称
     :value：数据绑定
  -->
  <v-select multiple
          placeholder="请选择关联的品牌"
          :options="brandList"
          label="text"
            :value="entity.brandIds"></v-select>
  ```

- 组件数据

  ```
  brandList: [{id : 1, text : '华为'},{id : 2, text : '小米'},{id : 3, text : '红米'}] // 品牌数组
  ```

#### 小结

> 组件数据格式：[{id : 1, text : '华为'},{id : 2, text : '小米'},{id : 3, text : '红米'}]

## 15_品牌下拉列表

#### 目标

> 实现品牌下拉列表数据来自品牌表

#### 实现步骤

- 前端实现

    发送异步请求，查询所有的品牌

- 后端实现

   select id,name from tb_brand

#### 小结

![1561782695918](assets/1561782695918.png)

## 16_规格下拉列表

#### 目标

> 实现规格下拉列表数据来自规格表

#### 实现步骤

> 参考品牌下拉列表实现步骤

## 17_模板扩展属性

#### 目标

> 实现模板扩展属性的动态添加

#### 实现步骤

- 增加行
- 删除行

#### 小结

> 数据封装,数组的操作。entity.customAttributeItems = [{text: ''}]

## 18_添加模板

#### 目标

> 实现添加模板后端代码

#### 操作步骤

- 往类型模板表插入数据

#### 小结

> 接收请求参数，往类型模板表插入一行数据(单张操作,用通用Mapper中的选择性添加方法实现)

## 19_修改模板

#### 目标

> 实现修改模板功能

#### 操作步骤

- 前端实现

  ![1561784405936](assets/1561784405936.png)

- 后端实现

#### 小结

> 前端数据回显
>
> 后端修改模板表中的数据

## 20_删除模板

#### 目标

> 实现删除模板功能

#### 操作步骤

- 前端实现
- 后端实现

#### 小结

> 前端传递多个模板id参数到后端，后端完成模板表的数据删除。

## 21_优化模板列表显示

#### 目标

> 实现优化模板列表的显示

#### 实现步骤

- 关联品牌显示
- 关联规格显示
- 扩展属性显示

#### 小结

> 只显示品牌名称、规格名称、扩展属性名称。